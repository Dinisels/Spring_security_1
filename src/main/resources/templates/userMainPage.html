<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>All users</title>
    <style>
        table { border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 6px 10px; }
        form.inline { display: inline; margin: 0; padding: 0; }
    </style>

    <!-- CSRF мета (удобно для AJAX) -->
    <meta th:if="${_csrf != null}" name="_csrf" th:content="${_csrf.token}" />
    <meta th:if="${_csrf != null}" name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<body>

<h2>All users</h2>

<div th:if="${users == null or #lists.isEmpty(users)}">
    <p>No users found.</p>
</div>

<table th:if="${users != null and !#lists.isEmpty(users)}">
    <thead>
    <tr>
        <th>Name</th>
        <th>Age</th>
        <th>Email</th>
        <th>Update</th>
        <th>Delete</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="user : ${users}">
        <td th:text="${user.name}">Name</td>
        <td th:text="${user.age}">Age</td>
        <td th:text="${user.email}">Email</td>

        <td>
            <button type="button"
                    th:onclick="|window.location.href='@{/updateUser(userId=${user.id})}'|">
                Update
            </button>
        </td>

        <td>
            <form class="inline" th:action="@{/deleteUser}" method="post">
                <input type="hidden" name="userId" th:value="${user.id}" />
                <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <button type="submit"
                        th:attr="data-username=${user.name}"
                        onclick="return confirm('Удалить пользователя ' + this.dataset.username + '?');">
                    Delete
                </button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

<br/><br/>

<button type="button" th:onclick="|window.location.href='@{/addNewUser}'|">Add new user</button>

</body>
</html>
